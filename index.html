<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">

<meta name="theme-color" content="#1E003D"/> <link rel="apple-touch-icon" href="img/phonechat.png"/>

<title>Phone Chat</title>

<meta name="description" content="try to chat"/>
<meta name="viewport" content="width=device-width" initial-scale=1.0>
<!--<link rel="stylesheet" href="styles.css">-->
<link rel="manifest" href="manifest.json">

<script >
    async function showNotification() {
	const result = await Notification.requestPermission();
	if (result === 'granted') {
		const noti = new Notification('Hello!', {
			body: 'Itâ€™s me.'
		});
		noti.onclick = () => alert('clicked');

		
	}
	    alert("where is noti?");
}

    //localStorage.total=0;
    
       async function getClipboardContent() {
  try {
    const textcb = await navigator.clipboard.readText();
    //alert('Pasted content: ', textcb);
      document.getElementById('text').value=textcb;
      changetext();
  } catch (err) {
    alert('Failed to read clipboard contents: ', err);
  }
}
       function checkStorage(){
           alert(localStorage.test);
           localStorage.test = document.getElementById("text").value;
           
           }
       function changetext()
{
        txt="";
utotal = 0;
       var parent = document.getElementById("parent");
        txt=document.getElementById('text').value;
        
        regtxt=txt.match(/\d+/g).join('');
       
        document.getElementById('text').value=regtxt;
	alert(utotal);
    utotal=parseInt(localStorage.total,10)+1;
	alert(utotal);
    localStorage.setItem("item"+utotal,regtxt);
    localStorage.total=utotal;
    
var p = document.createElement('p');
p.innerHTML = localStorage.getItem("item"+utotal);
        parent.prepend(p);
alert("ok");
        //document.getElementById('myform').submit();
}
    
    
</script>

<style>         
#text
{
height:100px;
width:100%;
font-size:50px;
color:white;
background:cadetblue;
}
</style>
</head>

<body>
step-n2
<form id="myform" action="https://api.whatsapp.com/send">

<input id="storage" type="button" value="check storage" onClick="checkStorage();">
<input id="cb" type="button" value="get clipboard" onClick="getClipboardContent();">
	<input id="nb" type="button" value="notification test" onClick="showNotification();">
<input id="text" type="text" name="phone">

<div id="parent"></div>
	</form>
<script>
    let parent = document.getElementById("parent");
    for (let i = 1; i <= parseInt(localStorage.total,10); i++) {
	let p = document.createElement('p');
p.innerHTML = localStorage.getItem("item"+i);
        parent.prepend(p);
}
if('serviceWorker' in navigator){ navigator.serviceWorker.register('/service-worker.js');} else { console.log("Service worker is not supported"); }
</script>

</body>
</html>
